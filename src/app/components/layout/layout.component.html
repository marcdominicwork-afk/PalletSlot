<div class="min-h-screen bg-slate-50">
  <header class="bg-gradient-to-r from-slate-900 to-slate-800 text-white shadow-md">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex items-center justify-between h-16">
        <div class="flex items-center">
          <a routerLink="/booking" class="flex items-center space-x-2 text-white">
            <i-lucide [img]="Truck" class="w-8 h-8 text-blue-500"></i-lucide>
            <span class="text-xl font-bold">PalletSlot</span>
          </a>
        </div>

        <nav class="hidden md:flex items-center space-x-4">
          <a *ngFor="let link of publicLinks"
             [routerLink]="link.path"
             [target]="link.newTab ? '_blank' : '_self'"
             [rel]="link.newTab ? 'noopener noreferrer' : ''"
             routerLinkActive="bg-blue-600"
             [routerLinkActiveOptions]="{exact: false}"
             class="flex items-center space-x-2 px-3 py-2 rounded-md text-sm font-medium text-slate-200 hover:bg-blue-800 hover:text-white transition-colors">
            <i-lucide [img]="getIconComponent(link.icon)" class="w-4 h-4"></i-lucide>
            <span>{{link.name}}</span>
          </a>

          <div *ngIf="user && (user.role === 'admin' || user.role === 'company_admin')" class="relative">
            <button (click)="toggleAdminMenu()"
                    class="flex items-center space-x-2 px-3 py-2 rounded-md text-sm font-medium transition-colors"
                    [class.bg-blue-600]="isAdminMenuOpen"
                    [class.text-slate-200]="!isAdminMenuOpen"
                    [class.hover:bg-blue-800]="!isAdminMenuOpen">
              <span>Admin</span>
              <i-lucide [img]="ChevronDown" class="w-4 h-4 transition-transform" [class.rotate-180]="isAdminMenuOpen"></i-lucide>
            </button>
            <div *ngIf="isAdminMenuOpen"
                 class="absolute left-0 mt-2 w-48 bg-white rounded-md shadow-lg py-1 z-50"
                 (mouseleave)="closeAdminMenu()">
              <a *ngFor="let item of getFilteredAdminLinks()"
                 [routerLink]="item.path"
                 (click)="closeAdminMenu()"
                 class="flex items-center space-x-2 px-4 py-2 text-sm text-slate-700 hover:bg-slate-100">
                <i-lucide [img]="getIconComponent(item.icon)" class="w-4 h-4"></i-lucide>
                <span>{{item.name}}</span>
              </a>
            </div>
          </div>
        </nav>

        <div class="flex items-center space-x-4">
          <div *ngIf="isLoading" class="text-slate-400">
            <i-lucide [img]="Loader2" class="w-6 h-6 animate-spin"></i-lucide>
          </div>
          <div *ngIf="!isLoading && user" class="flex items-center space-x-4">
            <span class="hidden sm:inline text-sm text-slate-300">Welcome, {{user.full_name}}</span>
            <button (click)="handleLogout()"
                    class="p-2 text-slate-300 hover:bg-blue-800 hover:text-white rounded-md transition-colors"
                    title="Logout">
              <i-lucide [img]="LogOut" class="w-5 h-5"></i-lucide>
            </button>
          </div>

          <button (click)="toggleMobileMenu()"
                  class="md:hidden p-2 text-white hover:bg-blue-800 rounded-md transition-colors"
                  [attr.aria-label]="isMobileMenuOpen ? 'Close menu' : 'Open menu'">
            <i-lucide [img]="Menu" *ngIf="!isMobileMenuOpen" class="w-6 h-6"></i-lucide>
            <i-lucide [img]="X" *ngIf="isMobileMenuOpen" class="w-6 h-6"></i-lucide>
          </button>
        </div>
      </div>

      <div *ngIf="isMobileMenuOpen"
           class="md:hidden border-t border-slate-700 py-4 space-y-2">
        <a *ngFor="let link of publicLinks"
           [routerLink]="link.path"
           [target]="link.newTab ? '_blank' : '_self'"
           [rel]="link.newTab ? 'noopener noreferrer' : ''"
           (click)="!link.newTab && closeMobileMenu()"
           routerLinkActive="bg-blue-600"
           [routerLinkActiveOptions]="{exact: false}"
           class="flex items-center space-x-2 px-3 py-2 rounded-md text-sm font-medium text-slate-200 hover:bg-blue-800 hover:text-white transition-colors">
          <i-lucide [img]="getIconComponent(link.icon)" class="w-4 h-4"></i-lucide>
          <span>{{link.name}}</span>
        </a>

        <div *ngIf="user && (user.role === 'admin' || user.role === 'company_admin')">
          <button (click)="toggleAdminMenu()"
                  class="w-full flex items-center justify-between px-3 py-2 rounded-md text-sm font-medium text-slate-200 hover:bg-blue-800 hover:text-white transition-colors">
            <span>Admin</span>
            <i-lucide [img]="ChevronDown" class="w-4 h-4 transition-transform" [class.rotate-180]="isAdminMenuOpen"></i-lucide>
          </button>
          <div *ngIf="isAdminMenuOpen" class="ml-4 mt-2 space-y-2">
            <a *ngFor="let item of getFilteredAdminLinks()"
               [routerLink]="item.path"
               (click)="closeMobileMenu()"
               routerLinkActive="bg-blue-600"
               class="flex items-center space-x-2 px-3 py-2 rounded-md text-sm text-slate-300 hover:bg-blue-800 hover:text-white transition-colors">
              <i-lucide [img]="getIconComponent(item.icon)" class="w-4 h-4"></i-lucide>
              <span>{{item.name}}</span>
            </a>
          </div>
        </div>
      </div>
    </div>
  </header>

  <main>
    <div class="max-w-7xl mx-auto py-6 sm:px-6 lg:px-8">
      <ng-content></ng-content>
    </div>
  </main>
</div>
